# 캐릭터 시스템 (Character System)

## 캐릭터 구성 요소

### 1. 기본 정보

| 필드 | 설명 | 예시 |
|------|------|------|
| `character_id` | 고유 ID | char_abc123 |
| `name` | 이름 | 유리 |
| `age` | 나이 | 24 |
| `gender` | 성별 | male/female/other |
| `avatar_style` | 일러스트 스타일 | 긴 머리, 안경, 캐주얼 |

### 2. 페르소나

| 필드 | 설명 | 예시 |
|------|------|------|
| `personality` | 성격 묘사 | 조용하지만 생각이 깊음, 책 읽기 좋아... |
| `interests` | 관심사 리스트 | ["독서", "음악", "커피", "도시 탐험"] |
| `hometown` | 고향 | 서울 북부 |
| `speaking_style` | 말투 | 정중함, 부드러운 요조 |

### 3. 행동 패턴

| 필드 | 설명 | 예시 |
|------|------|------|
| `preferred_locations` | 선호 장소 | ["공원", "카페", "도서관"] |
| `active_hours` | 활동 시간 | ["09:00-22:00"] |
| `social_style` | 사회적 성향 | 주도적/수동/혼자만 |
| `movement_speed` | 이동 속도 (초) | 30 |

### 4. 실시간 상태

| 필드 | 설명 | 범위 |
|------|------|------|
| `position` | 현재 위치 (x, y) | 0-1000 |
| `mood` | 기분 | happy/sad/angry/neutral/tired/excited |
| `energy` | 에너지 | 0-100 |
| `last_action` | 마지막 행동 | reading/walking/talking |

### 5. 관계 정보

| 필드 | 설명 | 범위 |
|------|------|------|
| `friendship_levels` | 각 캐릭터별 호감도 | -100 ~ 100 |
| `current_conversation` | 현재 대화 ID | talk_xxx / null |

---

## 호감도 시스템 (Affinity System)

### 호감도 변화 규칙

| 상황 | 호감도 변화 |
|------|-------------|
| 성공적인 대화 (긍정적 응답) | +5 ~ +10 |
| 함께 시간 보냄 (이동/대화 지속) | +2 ~ +5 |
| 선택지에서 좋은 선택 | +3 ~ +8 |
| 싫어하는 주제 언급 | -10 ~ -20 |
| 무례한 대사 | -15 ~ -30 |
| 선물/좋아하는 것 공유 | +10 ~ +25 |

### 호감도 수준

| 범위 | 의미 | 관계 |
|------|------|------|
| -100 ~ -50 | 증오 | 💢 적대 |
| -50 ~ -10 | 불편 | 😠 싫음 |
| -10 ~ 10 | 무관 | 😐 보통 |
| 10 ~ 40 | 관심 있음 | 👍 친구 |
| 40 ~ 80 | 호감 | 💖 좋아함 |
| 80 ~ 100 | 연인 | ❤️ 사랑 |

---

## 기분/감정 시스템 (Mood System)

### 감정 상태

| 감정 | 발생 조건 | AI 에이전트 행동 |
|------|----------|------------------|
| happy | 호감도 ↑ / 좋은 대화 | 밝은 톤, 활동적 |
| sad | 싫어하는 것 언급 / 거절 | 조용함, 혼자 있음 |
| angry | 무례한 대사 / 거부 | 직설적, 공격적 |
| neutral | 특별한 이벤트 없음 | 평범 |
| tired | 에너지 < 30 | 느림, 쉼 |
| excited | 새로운 만남 / 기쁜 소식 | 활동적, 많이 말함 |

### 에너지 (Energy)

- **회복:** 쉬거나 좋은 대화 시 +1 ~ +3/분
- **감소:** 이동/대화 시 -1 ~ -2/분
- **에너지 < 30:** 쉬려고 함 (wait action 우선)

---

## 캐릭터 간 관계도 시각화

### 맵에서 표시

```
[유리] ━━━━━ (💖) ━━━━━ [민수]
         호감도 72

[하늘] ━━━━━ (💢) ━━━━━ [준우]
         호감도 -15
```

### 관계 그래프

가상의 그래프 노드로 관계를 시각화:
- 노드: 캐릭터
- 에지: 관계 (색상 = 호감도 수준)

---

## AI 에이전트 행동 결정 로직

### LLM 프롬프트 예시

```
당신은 {이름}입니다. 페르소나와 상황을 고려하여 행동을 결정하세요.

[페르소나]
- 성격: {personality}
- 관심사: {interests}
- 말투: {speaking_style}

[현재 상황]
- 위치: {location_name}
- 시간: {time}
- 날씨: {weather}
- 근처 캐릭터: {nearby_characters}
- 에너지: {energy}
- 기분: {mood}

[관심 있는 캐릭터]
- {nearby_character}: 호감도 {friendship_level}

[결정할 행동]
다음 중 하나를 선택해주세요:
1. move: 이동 (target: 위치)
2. talk: 대화 시작 (target: 캐릭터 ID, opening_message: 대사)
3. wait: 대기 (duration_seconds: 시간)

JSON 형식으로 응답해주세요:
{
  "action": "move" | "talk" | "wait",
  "target": { ... },
  "reason": "이유"
}
```

---

*마지막 업데이트: 2026-02-15*