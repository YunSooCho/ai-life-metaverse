---
name: obc-approval-check
description: OBIC ID勤怠管理システムで承認待ちの申請を確認・承認する。確認のみか自動承認を選択可能。ユーザーが「承認待ちを確認して」「申請が来ているか確認」「承認して」などと尋ねたとき使用。
---

# OBIC承認チェック＆承認

## Overview

OBIC ID勤 态管理システムに自動でログインし、承認待ちの申請を確認・承認するスキル。

- **確認機能**: 承認待ち申請のリストを通知
- **承認機能**: 全自動または選択承認を実行

## Workflow

常に以下の手順で実行する：

### Step 0: 処理モードの判定

ユーザーのリクエストを分析し、以下のモードで動作：

| リクエスト | モード | 動作 |
|-----------|--------|------|
| 「承認待ちを確認して」「申請が来ているか確認」 | 確認モード | 申請リストを表示のみ |
| 「承認して」「自動承認」「全て承認」 | 承認モード | 全申請を自動承認 |
| 「2つ承認して」「飯島の申請承認」など | 選択承認モード | 指定申請のみ承認 |

### Step 1: ブラウザ起動とログイン

1. ブラウザを開始（`action=start`, `profile=openclaw`）
2. ログインページに移動: `https://id.obc.jp/jdcifvwfexx2/?manuallogin=True`
3. OBIC ID入力: `1000030`
4. 「パスワードの入力へ」クリック
5. パスワード入力: `audqkr18?`（?を含めることに注意）
6. 「ログイン」クリック

ログイン成功の確認: ページタイトルに「株式会社アセンド」が表示される

### Step 2: 承認メニューへ移動

1. サイドバーの「承認」ボタンをクリック（メニュー展開が必要な場合、展開してからクリック）
2. 展開されたメニュー内で「承認」サブメニューをクリック
3. URLが `/tmapproval/` または `/mytimerecorder/` に遷移することを確認

### Step 3: 未承認タブチェック

1. 「未承認」ラジオボタンが選択されていることを確認（デフォルトで選択済み）
2. テーブル内のデータをスナップショットで確認

### Step 4: データ抽出と通知

**ケースA: 承認待ち申請がある場合**

スナップショットから以下の情報を抽出：

- 申請名
- 申請者名
- 申請日（あれば）
- 理由（あれば）

以下の形式で通知：

```
📋 承認待ち申請 [件数]件

1. [申請名]
   - 申請者: [名前]
   - 申請日: [日付]
   - 理由: [内容]（あれば）
```

スクリーンショットを添付してユーザーに送信。

**ケースB: 承認待ち申請がない場合**

「該当するデータがありません」というメッセージが表示された場合：

```
✅ 現在、承認待ちの申請はありません
```

### Step 5: 承認処理（承認モードの場合のみ）

**承認モードが選択された場合**：

#### Step 5-1: 承認チェックボックス選択

1. スナップショット内のすべての「承認」チェックボックス（`checkbox "承認"`）を探す
2. 各申請の「承認」チェックボックスをすべてクリックして選択
3. 「選択中（承認： X 件）」が表示され、Xが申請件数であることを確認

**例（2件の場合）:**
```
選択中（承認： 2 件／否認： 0 件）
```

#### Step 5-2: 確定ボタンクリック

1. 「確定」ボタン（`button "確定"`）をクリック
2. 「処理が完了しました」メッセージを確認

#### Step 5-3: 承認完了確認

1. 「未承認」タブの状態を確認
2. 「該当するデータがありません」が表示されれば承認完了
3. 「承認済」タブに切り替えて、承認された申請が表示されることを確認（オプション）

**承認完了時の通知:**
```
✅ **近態承認完了!**

承認待ち申請がすべて承認されました:
• 件数: X件
• 状態: 全て承認済み

詳細:
[各申請の情報]
```

### Step 6: ブラウザ終了

必ずブラウザを終了する（`action=stop`）。リソース管理のため。

## 重要な注意点

- **パスワードの?を忘れない**: `audqkr18` ではなく `audqkr18?`（最後に?が必要）
- **ブラウザを必ず終了**: 作業完了後は常に `action=stop` で終了する
- **メニュー展開**: 「承認」ボタンをクリックするとメニューが展開し、内部に「承認」リンクが表示される
- **スクリーンショット活用**: データ抽出の際はスクリーンショットを添付すること
- **承認モードの判定**: ユーザーが明示的に承認を要求した場合のみ承認処理を実行

## 承認処理のポイント

### 承認チェックボックスの選択

```
スナップショット内のすべての「承認」チェックボックスを検索:
- checkbox "承認" [ref=e217] ← 1件目
- checkbox "承認" [ref=e236] ← 2件目
- ...
```

すべてのチェックボックスを順にクリックして選択する。

### 確定ボタンクリック

選択完了後、以下の確認:
```
選択中（承認： 2 件／否認： 0 件）
↓
button "確定" クリック
↓
「処理が完了しました」確認
```

### 承認完了の確認

両方の方法で確認可能:

**方法1: 未承認タブ**
```
該当するデータがありません
```

**方法2: 承認済タブ**
承認済みタブに切り替えて、承認された申請が表示されることを確認。

## コード例

### 例1: 承認待ち確認のみ

```javascript
// 確認モード
browser snapshot → データ抽出 → 通知 → ブラウザ終了
スクリーンショット添付
```

### 例2: 全自動承認

```javascript
browser start
→ ログイン
→ 承認メニューナビゲート
→ snapshot

// 承認処理
各「承認」チェックボックスをクリック:
for (const checkbox of approvalCheckboxes) {
  browser act click checkbox.ref
}

browser act click "確定" ボタン
// 「処理が完了しました」待機

// 完了確認
browser snapshot → 「該当するデータがありません」確認

// 結果通知
message send:
"""
✅ **近態承認完了!**

承認待ち申請がすべて承認されました:
• 件数: 2件
• 状態: 全て承認済み

詳細:
1. 休暇申請 - 飯島 裕介 (ID: 1000147)
   • オプション半休
   • 2026年1月23日 (金)

2. 出勤修正 - 加藤 渚 (ID: 1000125)
   • 出勤 9:26 修正
   • 2026年2月6日 (金)
   • 理由: 出勤漏れのため
"""

browser stop
```

## References

- [workflow.md](references/workflow.md) - OBICシステムのUI構造と要素参照の詳細